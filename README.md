# 江苏税务文件中转客户端

（此处插入项目主界面截图）

------------------------------------------------------------------------

## 📌 项目简介

江苏税务文件中转客户端是一个基于**ttkbootstrap**的图形界面桌面应用，用于江苏税务云盘的外网文件中转操作。
本项目结构清晰、界面现代，包含完整的日志系统、异常捕获、多线程上传/下载等企业级实践。

功能包括：

-   文本一键上传
-   文件拖拽上传（多文件）
-   验证码自动轮询校验
-   内传外文件列表查询
-   批量文件多选下载
-   日志输出 + 状态栏提示
-   UI 与网络通信解耦设计

------------------------------------------------------------------------

## 🚀 安装与运行

###方式一：直接下载可执行文件
-   访问 Releases 页面
-   下载最新版本的 TaxCloudClient.exe
-   直接双击运行，无需安装依赖

###方式二：从源码运行
#### 1. 克隆仓库

``` bash
git clone https://github.com/yourname/yourrepo.git
cd yourrepo
```

#### 2. 安装依赖（Python 3.8+）

``` bash
pip install -r requirements.txt
```

#### 3. 运行程序

``` bash
python main.py
```

## 📖 使用指南
###基本操作流程
####1.启动程序
-   双击运行 TaxCloudClient.exe
-   初次运行需要配置税务云地址
-   输入验证码
-   在顶部输入框输入6位数字验证码
-   点击"确定"按钮进行验证
####2.上传文件
-   文本上传: 在左侧文本区域输入内容，点击"文本上传"
-   文件上传: 直接将文件拖拽到右侧区域
####3.下载文件
-   点击"下载"按钮查看可下载文件列表
-   选择文件并保存到本地

###界面说明
-   顶部控制区: 验证码输入和功能按钮
-   文本输入区: 编辑要上传的文本内容
-   文件拖拽区: 拖放文件到此区域上传
-   日志显示区: 实时显示操作状态和结果

------------------------------------------------------------------------
## 🔨 编译指南

如需自行编译，请使用以下命令：
``` bash
# 安装 Nuitka
pip install nuitka

# 编译为单文件可执行程序
nuitka --standalone --onefile --windows-console-mode=disable --enable-plugin=tk-inter --output-filename=TaxCloudClient.exe main.py
```
## 🧰 主要依赖

-   ttkbootstrap
-   tkinterdnd2
-   requests

------------------------------------------------------------------------

## 📁 项目结构

    ├── main.py                # 主程序
    ├── README.md              # 项目文档
    ├── requirements.txt       # 依赖列表
    ├── LICENSE                # 开源许可
    └── screenshots/           # 截图文件夹

------------------------------------------------------------------------

## 🔧 技术特点

### 1. 网络层与界面层彻底解耦

-   使用 `RequestClient` 单独封装所有 HTTP 请求逻辑。
-   统一网络入口 `safe_request()`，实现异常捕获、防崩溃保护、默认空 JSON 返回。
-   所有界面操作通过回调或 `after()` 在主线程执行，保证线程安全。

### 2. 全程多线程后台任务处理
 
-   上传 / 下载 / 验证 均在独立线程中执行。
-   界面不卡顿，操作流畅，任务完成后自动切回 UI 主线程更新控件与日志。

### 3. 支持文件拖拽上传

-   基于 `tkinterdnd2` 实现拖拽区域，可一次拖拽多个文件。
-   根据系统是否支持拖拽自动回退为文件选择按钮，增强兼容性。

### 4. 文本上传与本地文件上传双模式

-   文本框内容可直接作为文本文件上传（自动生成带时间戳的文件名）。
-   文件上传自动识别 MIME 类型。

### 5. 完整的验证码轮询验证功能

-   验证码输入后后台轮询验证（每 60 秒刷新一次）。
-   验证失败自动锁定界面、清空验证码、要求重新输入。
-   支持验证码重置功能。

### 6. 文件列表获取与多文件下载

-   支持查询验证码下所有可下载文件。
-   文件下载支持多选，自动打包 ZIP。
-   下载后弹出文件保存对话框，路径自由选择。

### 7. 自带日志系统（带时间戳 + 状态栏同步）

-   每条日志带精确时间戳。
-   底部状态栏实时显示最新日志摘要。
-   日志框自动滚动，便于排查与跟踪行为。

### 8. 基于 ttkbootstrap 的现代化界面

-   使用 `flatly` 主题构建更加现代的 UI。
-   控件风格统一：按钮、标签、卡片面板、滚动文本区域全部美化。
-   自适应窗口大小，自动居中。

### 9. 健壮性设计

-   多处异常捕获，避免界面冻结或程序崩溃。
-   采用明确的模块划分：UI Layer / Network Layer / Task Thread。
-   提供适合作为模板的中小型 Tkinter 企业项目结构。

### 10. 完善的配置管理

-   自动读取/写入 config.ini：启动时自动加载 HOST，无需每次输入。
-   提供专门的“配置地址”对话框，含 IP 格式校验与自动清理协议头。
-   配置错误时自动弹窗提示。

------------------------------------------------------------------------

## 📄 开源协议

本项目基于 MIT License
开源，可自由用于个人或商业用途，但需保留版权声明。

------------------------------------------------------------------------

## 🤝 贡献

欢迎 PR、Issue 或建议改进！

------------------------------------------------------------------------

## ⭐ 支持本项目

如果你觉得这个项目对你有帮助，请给一个 Star ⭐！
